"use strict";(self.webpackChunkgreen_public=self.webpackChunkgreen_public||[]).push([[4648],{24648:($,h,s)=>{s.d(h,{ProtectedListPage:()=>ts});var _=s(74081),e=s(27279),r=s(93153),n=s(50086),i=s(32370),m=s(10701),R=s(93415),P=s(4987),D=s(73354),l=s(27875),L=s(48102),T=s(37472),M=s(74758),U=s(70774),K=s(38566),x=s(38101),f=s(10989),N=s(86967),t=s(15530),c=s(36938),j=s(78031),H=s(26784),Y=s(78665),G=s(53532),J=s(61815),F=s(61020),b=s(51447),Q=s(24468),k=s(87137),V=s(66947),Ds=s(15816),Ms=s(97442),Os=s(13576),Ps=s(87830),Ts=s(47184),Cs=s(364),hs=s(59461),ms=s(40464),Rs=s(71563),Ls=s(49204),As=s(47853),cs=s(74919),gs=s(29206),vs=s(98934),Bs=s(43433),Ws=s(75719),Is=s(8175),Us=s(6078),Ks=s(51943),xs=s(55783),fs=s(92249),js=s(41942),us=s(22919),ys=s(53915),ps=s(75041),Zs=s(30200),Ss=s(91379),$s=s(33299),Ns=s(33409),Fs=s(63645),Qs=s(7988),Vs=s(7055),zs=s(26757),Xs=s(58311),Hs=s(29510),Ys=s(16946),Gs=s(10124),Js=s(69530),bs=s(86961),ks=s(51527),ws=s(19764),qs=s(42982),s_=s(26126),__=s(64797),t_=s(85811);const w=({id:a,name:C,description:E,usersCount:g,icons:v,rowIndex:u,canUpdate:B})=>{const{formatMessage:W}=(0,F.Z)(),[,A]=v,y=W({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:g});return(0,_.jsxs)(r.Tr,{"aria-rowindex":u,...B?(0,t.X7)({fn:A.onClick}):{},children:[(0,_.jsx)(n.Td,{maxWidth:(0,t.Q1)(130),children:(0,_.jsx)(i.Z,{ellipsis:!0,textColor:"neutral800",children:C})}),(0,_.jsx)(n.Td,{maxWidth:(0,t.Q1)(250),children:(0,_.jsx)(i.Z,{ellipsis:!0,textColor:"neutral800",children:E})}),(0,_.jsx)(n.Td,{children:(0,_.jsx)(i.Z,{textColor:"neutral800",children:y})}),(0,_.jsx)(n.Td,{children:(0,_.jsx)(m.k,{justifyContent:"flex-end",...t.UW,children:v.map((d,I)=>d?(0,_.jsx)(R.x,{paddingLeft:I===0?0:1,children:(0,_.jsx)(P.h,{onClick:d.onClick,label:d.label,borderWidth:0,icon:d.icon})},d.label):null)})})]},a)},q=()=>{const{formatMessage:a}=(0,F.Z)();(0,t.go)();const C=(0,Q.f)(V.s),{formatAPIError:E}=(0,t.So)(),g=(0,t.lm)(),[v,u]=e.useState(!1),[{query:B}]=(0,t.Kx)(),{isLoading:W,allowedActions:{canCreate:A,canDelete:y,canRead:d,canUpdate:I}}=(0,t.ss)(C.settings?.roles),{roles:z,refetch:as}=(0,k.u)({filters:B?._q?{name:{$containsi:B._q}}:void 0},{cacheTime:0,enabled:!W&&d}),{push:p}=(0,b.k6)(),[{showModalConfirmButtonLoading:os,roleToDelete:ns},Z]=e.useReducer(_s,ss),{post:Es}=(0,t.tg)(),ls=async()=>{try{Z({type:"ON_REMOVE_ROLES"}),await Es("/admin/roles/batch-delete",{ids:[ns]}),await as(),Z({type:"RESET_DATA_TO_DELETE"})}catch(o){o instanceof G.d7&&g({type:"warning",message:E(o)})}S()},X=()=>p("/settings/roles/new"),S=()=>u(o=>!o),is=o=>O=>{O.preventDefault(),O.stopPropagation(),o.usersCount?g({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):(Z({type:"SET_ROLE_TO_DELETE",id:o.id}),S())},ds=o=>O=>{O.preventDefault(),O.stopPropagation(),p(`/settings/roles/duplicate/${o.id}`)},es=z.length+1,rs=6;return W?(0,_.jsx)(D.o,{children:(0,_.jsx)(t.dO,{})}):(0,_.jsxs)(D.o,{children:[(0,_.jsx)(t.SL,{name:"Roles"}),(0,_.jsx)(l.T,{primaryAction:A?(0,_.jsx)(L.z,{onClick:X,startIcon:(0,_.jsx)(c.Z,{}),size:"S",children:a({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})}):null,title:a({id:"global.roles",defaultMessage:"roles"}),subtitle:a({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),d&&(0,_.jsx)(T.Z,{startActions:(0,_.jsx)(t.m,{label:a({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:a({id:"global.roles",defaultMessage:"roles"})})})}),d&&(0,_.jsx)(M.D,{children:(0,_.jsxs)(U.i,{colCount:rs,rowCount:es,footer:A?(0,_.jsx)(K.c,{onClick:X,icon:(0,_.jsx)(c.Z,{}),children:a({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})}):null,children:[(0,_.jsx)(x.h,{children:(0,_.jsxs)(r.Tr,{"aria-rowindex":1,children:[(0,_.jsx)(n.Th,{children:(0,_.jsx)(i.Z,{variant:"sigma",textColor:"neutral600",children:a({id:"global.name",defaultMessage:"Name"})})}),(0,_.jsx)(n.Th,{children:(0,_.jsx)(i.Z,{variant:"sigma",textColor:"neutral600",children:a({id:"global.description",defaultMessage:"Description"})})}),(0,_.jsx)(n.Th,{children:(0,_.jsx)(i.Z,{variant:"sigma",textColor:"neutral600",children:a({id:"global.users",defaultMessage:"Users"})})}),(0,_.jsx)(n.Th,{children:(0,_.jsx)(f.T,{children:a({id:"global.actions",defaultMessage:"Actions"})})})]})}),(0,_.jsx)(N.p,{children:z?.map((o,O)=>(0,_.jsx)(w,{id:o.id,name:o.name,description:o.description,usersCount:o.usersCount,icons:[A&&{onClick:ds(o),label:a({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:(0,_.jsx)(j.Z,{})},I&&{onClick:()=>p(`/settings/roles/${o.id}`),label:a({id:"app.utils.edit",defaultMessage:"Edit"}),icon:(0,_.jsx)(H.Z,{})},y&&{onClick:is(o),label:a({id:"global.delete",defaultMessage:"Delete"}),icon:(0,_.jsx)(Y.Z,{})}].filter(Boolean),rowIndex:O+2,canUpdate:I},o.id))})]})}),(0,_.jsx)(t.QH,{isOpen:v,onConfirm:ls,isConfirmButtonLoading:os,onToggleDialog:S})]})},ss={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},_s=(a,C)=>(0,J.ZP)(a,E=>{switch(C.type){case"ON_REMOVE_ROLES":{E.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{E.shouldRefetchData=!0,E.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{E.shouldRefetchData=!1,E.roleToDelete=null,E.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{E.roleToDelete=C.id;break}default:return E}}),ts=()=>{const a=(0,Q.f)(V.s);return(0,_.jsx)(t.O4,{permissions:a.settings?.roles.main,children:(0,_.jsx)(q,{})})}},87137:($,h,s)=>{s.d(h,{u:()=>i});var _=s(27279),e=s(15530),r=s(61020),n=s(40464);const i=(m={},R={})=>{const{id:P="",...D}=m,{get:l}=(0,e.kY)(),{locale:L}=(0,r.Z)(),T=(0,e.Xe)(L,{sensitivity:"base"}),{data:M,error:U,isError:K,isLoading:x,refetch:f}=(0,n.useQuery)(["roles",P,D],async()=>{const{data:t}=await l(`/admin/roles/${P??""}`,{params:D});return t},R);return{roles:_.useMemo(()=>{let t=[];return M&&(Array.isArray(M.data)?t=M.data:t=[M.data]),[...t].sort((c,j)=>T.compare(c.name,j.name))},[M,T]),error:U,isError:K,isLoading:x,refetch:f}}},38566:($,h,s)=>{s.d(h,{c:()=>D});var _=s(74081),e=s(19003),r=s(93415),n=s(84366),i=s(10701),m=s(32370);const R=(0,e.ZP)(r.x)`
  height: ${24/16}rem;
  width: ${24/16}rem;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;

  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
  }

  svg path {
    fill: ${({theme:l})=>l.colors.primary600};
  }
`,P=(0,e.ZP)(r.x)`
  border-radius: 0 0 ${({theme:l})=>l.borderRadius} ${({theme:l})=>l.borderRadius};
  display: block;
  width: 100%;
  border: none;
`,D=({children:l,icon:L,...T})=>(0,_.jsxs)("div",{children:[(0,_.jsx)(n.i,{}),(0,_.jsx)(P,{as:"button",background:"primary100",padding:5,...T,children:(0,_.jsxs)(i.k,{children:[(0,_.jsx)(R,{"aria-hidden":!0,background:"primary200",children:L}),(0,_.jsx)(r.x,{paddingLeft:3,children:(0,_.jsx)(m.Z,{variant:"pi",fontWeight:"bold",textColor:"primary600",children:l})})]})})]})}}]);
